{% extends "base.html" %}

{% block title %}Admin Dashboard{% endblock %}

{% block content %}
<div class="row mb-4">
    <div class="col-xl-3 col-md-6 mb-4">
        <div class="card h-100 hover-shadow border-0 shadow-sm">
            <div class="card-body">
                <h5 class="card-title text-muted">Total Staff</h5>
                <h2 class="display-4 fw-bold" style="color: var(--utm-maroon);">{{ staff_count }}</h2>
                <a href="{% url 'dashboard:staff_list' %}" class="btn btn-outline-secondary btn-sm">Manage Staff</a>
            </div>
        </div>
    </div>
    <div class="col-xl-3 col-md-6 mb-4">
        <div class="card h-100 hover-shadow border-0 shadow-sm">
            <div class="card-body">
                <h5 class="card-title text-muted">Active Task Forces</h5>
                <h2 class="display-4 fw-bold" style="color: var(--utm-maroon);">{{ taskforce_count }}</h2>
                <a href="{% url 'dashboard:taskforce_list' %}" class="btn btn-outline-secondary btn-sm">Manage Task
                    Forces</a>
            </div>
        </div>
    </div>
    <div class="col-xl-3 col-md-6 mb-4">
        <div class="card h-100 hover-shadow border-0 shadow-sm">
            <div class="card-body">
                <h5 class="card-title text-muted">Departments</h5>
                <h2 class="display-4 fw-bold" style="color: var(--utm-maroon);">{{ department_count }}</h2>
                <a href="{% url 'dashboard:department_list' %}" class="btn btn-outline-secondary btn-sm">Manage
                    Departments</a>
            </div>
        </div>
    </div>
    <div class="col-xl-3 col-md-6 mb-4">
        <div class="card h-100 hover-shadow border-0 shadow-sm">
            <div class="card-body">
                <h5 class="card-title text-muted">Audit Logs</h5>
                <p class="card-text text-muted mb-4">Track system security and user actions.</p>
                <a href="{% url 'dashboard:audit_log_list' %}" class="btn btn-outline-dark btn-sm">View
                    Logs</a>
            </div>
        </div>
    </div>
</div>

<div class="card shadow-sm mt-4">
    <div class="card-header card-header-custom d-flex justify-content-between align-items-center">
        <span><i class="bi bi-activity me-2"></i>Recent System Activity</span>
        <a href="{% url 'dashboard:audit_log_list' %}" class="btn btn-sm btn-light text-dark">View All</a>
    </div>
    <div class="card-body p-0">
        <div class="table-responsive">
            <table class="table table-striped mb-0 small">
                <thead>
                    <tr>
                        <th>Time</th>
                        <th>User</th>
                        <th>Action</th>
                        <th>Details</th>
                    </tr>
                </thead>
                <tbody>
                    {% for log in recent_logs %}
                    <tr>
                        <td class="text-nowrap text-muted">{{ log.timestamp|date:"M d, H:i" }}</td>
                        <td class="fw-bold">{{ log.actor.username|default:"System" }}</td>
                        <td>
                            <span
                                class="badge {% if 'LOGIN' in log.action %}bg-info{% elif 'REJECT' in log.action %}bg-danger{% elif 'APPROVE' in log.action %}bg-success{% else %}bg-secondary{% endif %}">
                                {{ log.action }}
                            </span>
                        </td>
                        <td class="text-muted">{{ log.details|truncatechars:40 }}</td>
                    </tr>
                    {% empty %}
                    <tr>
                        <td colspan="4" class="text-center py-3">No recent activity recorded.</td>
                    </tr>
                    {% endfor %}
                </tbody>
            </table>
        </div>
    </div>
</div>
{% endblock %}